function [ Grad ] = Get_Grad_Planar_Rad( x )
%Take in the vertex, two other points, and return the gradient
%

x1x= x(1);
x2x= x(2);
x3x= x(3);
x4x= x(4);
x1y= x(5);
x2y= x(6);
x3y= x(7);
x4y= x(8);
x1z= x(9);
x2z= x(10);
x3z= x(11);
x4z= x(12);

%These Things are Computed in Compute_Grad_Tet_Rad
d_x1x=(((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x2y - x3y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x2z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z) - (x1y - x4y)*(x2z - x3z) + (x2y - x3y)*(x1z - x4z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + (abs(x1x - x4x)*sign(x1x - x4x)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x1x=(((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x2y - x3y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x2z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z) - (x1y - x4y)*(x2z - x3z) + (x2y - x3y)*(x1z - x4z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + (abs(x1x - x4x)*sign(x1x - x4x)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);

d_x2x=(((x1y - x3y)*(x1z - x4z) - (x1y - x4y)*(x1z - x3z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1y - x3y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
      (((x1y - x3y)*(x1z - x4z) - (x1y - x4y)*(x1z - x3z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1y - x3y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);

d_x3x=-(((x1y - x2y)*(x1z - x4z) - (x1y - x4y)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1y - x2y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1z - x2z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
      -(((x1y - x2y)*(x1z - x4z) - (x1y - x4y)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1y - x2y) + 2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1z - x2z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2)


d_x4x=(((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - (abs(x1x - x4x)*sign(x1x - x4x)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
      (((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - (abs(x1x - x4x)*sign(x1x - x4x)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2)



d_x1y=(((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z) - (x1x - x4x)*(x2z - x3z) + (x2x - x3x)*(x1z - x4z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x2x - x3x) - 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x2z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + (abs(x1y - x4y)*sign(x1y - x4y)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x2y=-(((x1x - x3x)*(x1z - x4z) - (x1x - x4x)*(x1z - x3z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1x - x3x) - 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x1z - x3z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x3y=(((x1x - x2x)*(x1z - x4z) - (x1x - x4x)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - ((2*abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*sign((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))*(x1x - x2x) - 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x1z - x2z))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x4y=-(((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + (abs(x1y - x4y)*sign(x1y - x4y)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);


d_x1z=-(((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y) - (x1x - x4x)*(x2y - x3y) + (x2x - x3x)*(x1y - x4y))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + ((2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x2x - x3x) + 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x2y - x3y))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - (abs(x1z - x4z)*sign(x1z - x4z)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x2z=(((x1x - x3x)*(x1y - x4y) - (x1x - x4x)*(x1y - x3y))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + ((2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1x - x3x) + 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x1y - x3y))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x3z=-(((x1x - x2x)*(x1y - x4y) - (x1x - x4x)*(x1y - x2y))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) + ((2*abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*sign((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))*(x1x - x2x) + 2*abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*sign((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))*(x1y - x2y))*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/(2*(abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(3/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);
d_x4z=(((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(1/2)) - (abs(x1z - x4z)*sign(x1z - x4z)*((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))))/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)^(1/2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)^(3/2)))/(1 - ((x1z - x4z)*((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y)) - (x1y - x4y)*((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z)) + (x1x - x4x)*((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z)))^2/((abs((x1x - x2x)*(x1y - x3y) - (x1x - x3x)*(x1y - x2y))^2 + abs((x1x - x2x)*(x1z - x3z) - (x1x - x3x)*(x1z - x2z))^2 + abs((x1y - x2y)*(x1z - x3z) - (x1y - x3y)*(x1z - x2z))^2)*(abs(x1x - x4x)^2 + abs(x1y - x4y)^2 + abs(x1z - x4z)^2)))^(1/2);



Grad=[d_x1x d_x2x d_x3x d_x4x d_x1y d_x2y d_x3y d_x4y d_x1z d_x2z d_x3z d_x4z]';

end
