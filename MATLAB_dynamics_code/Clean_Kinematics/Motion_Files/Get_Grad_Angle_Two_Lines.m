function [ dx ] = Get_Grad_Angle_Two_Lines( x )
%Computed in Compute_Gradient_Angle_Rad_4_Points
%The order of the points is 1: kinematic point
% 2:Beginign of First Edge %3: End of First Edge 4: Begining of next edge 

x1x= x(1);
x2x= x(2);
x3x= x(3);
x4x= x(4);
x1y= x(5);
x2y= x(6);
x3y= x(7);
x4y= x(8);
x1z= x(9);
x2z= x(10);
x3z= x(11);
x4z= x(12);

dx1x=((x2x - x3x)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2x/2 - x1x + x4x/2)*sign(x2x/2 - x1x + x4x/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx2x=((x1x - x2x + x3x/2 - conj(x4x)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2x/2 - x1x + x4x/2)*sign(x2x/2 - x1x + x4x/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2x - x3x)*sign(x2x - x3x)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx3x=((x2x/2 - x1x + conj(x4x)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2x - x3x)*sign(x2x - x3x)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx4x=-((x2x/2 - x3x/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2x/2 - x1x + x4x/2)*sign(x2x/2 - x1x + x4x/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx1y=((x2y - x3y)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2y/2 - x1y + x4y/2)*sign(x2y/2 - x1y + x4y/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx2y=((x1y - x2y + x3y/2 - conj(x4y)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2y/2 - x1y + x4y/2)*sign(x2y/2 - x1y + x4y/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2y - x3y)*sign(x2y - x3y)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx3y=((x2y/2 - x1y + conj(x4y)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2y - x3y)*sign(x2y - x3y)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx4y=-((x2y/2 - x3y/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2y/2 - x1y + x4y/2)*sign(x2y/2 - x1y + x4y/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx1z=((x2z - x3z)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2z/2 - x1z + x4z/2)*sign(x2z/2 - x1z + x4z/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx2z=((x1z - x2z + x3z/2 - conj(x4z)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2z/2 - x1z + x4z/2)*sign(x2z/2 - x1z + x4z/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) + (abs(x2z - x3z)*sign(x2z - x3z)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx3z=((x2z/2 - x1z + conj(x4z)/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2z - x3z)*sign(x2z - x3z)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(3/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);
dx4z=-((x2z/2 - x3z/2)/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(1/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)) - (abs(x2z/2 - x1z + x4z/2)*sign(x2z/2 - x1z + x4z/2)*((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2)))/(2*(abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)^(3/2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)^(1/2)))/(1 - ((x2x - x3x)*(x2x/2 - x1x + conj(x4x)/2) + (x2y - x3y)*(x2y/2 - x1y + conj(x4y)/2) + (x2z - x3z)*(x2z/2 - x1z + conj(x4z)/2))^2/((abs(x2x/2 - x1x + x4x/2)^2 + abs(x2y/2 - x1y + x4y/2)^2 + abs(x2z/2 - x1z + x4z/2)^2)*(abs(x2x - x3x)^2 + abs(x2y - x3y)^2 + abs(x2z - x3z)^2)))^(1/2);

dx=[dx1x; dx2x; dx3x; dx4x; dx1y; dx2y; dx3y; dx4y; dx1z; dx2z; dx3z; dx4z];

end

